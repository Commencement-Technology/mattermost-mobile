name: prepare-ios-build
description: Action to prepare environment for ios build

runs:
  using: composite
  steps:
    - name: ci/install-os-deps
      shell: bash
      run: |
        echo "::group::install-os-deps"
        curl -Lo watchman.zip https://github.com/facebook/watchman/releases/download/2024.01.22.00_1/watchman-macos-2024.01.22.00_1.zip
        unzip -o watchman.zip
        chmod +x watchman
        mv watchman /usr/local/bin/
        echo "::endgroup::"

    - name: ci/prepare-mobile-build
      uses: ./.github/actions/prepare-mobile-build

    - name: ci/install-pods-dependencies
      shell: bash
      run: |
        echo "::group::install-pods-dependencies"
        npm run ios-gems
        npm run pod-install
        echo "::endgroup::"
